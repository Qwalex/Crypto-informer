#!/bin/bash

echo "============================================"
echo "   ü§ñ –°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram Chat ID"
echo "============================================"
echo

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–∫—Ä–∏–ø—Ç–∞
cd "$(dirname "$0")"

echo "üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
if [ ! -d "node_modules" ]; then
    echo "üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π npm..."
    npm install
    if [ $? -ne 0 ]; then
        echo "‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
        exit 1
    fi
fi

if [ ! -d "dist" ]; then
    echo "üî® –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞..."
    npm run build
    if [ $? -ne 0 ]; then
        echo "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞"
        exit 1
    fi
fi

echo
echo "üöÄ –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è Chat ID..."
echo
npm run get-chat-id

echo
echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"
echo "üí° –°–æ–≤–µ—Ç: –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è Chat ID, –∑–∞–ø—É—Å—Ç–∏—Ç–µ './start.sh' –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"
echo

read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
